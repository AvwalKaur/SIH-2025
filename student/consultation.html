<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultation & Support - DisasterSafe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a73e8;
            --secondary: #34a853;
            --accent: #f25c54;
            --warning: #f9a825;
            --safe: #4285f4;
            --light: #f8f9fa;
            --dark: #202124;
            --card-bg: #ffffff;
            --gradient-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --success: #28a745;
            --info: #17a2b8;
            --mental-health: #9c27b0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--gradient-bg);
            min-height: 100vh;
            color: var(--dark);
        }

        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .logo i {
            margin-right: 10px;
            color: var(--mental-health);
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-menu a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
        }

        .nav-menu a:hover {
            color: var(--primary);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 20px 40px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .page-title {
            font-size: 3rem;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .page-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 40px;
        }

        .chat-section {
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 700px;
        }

        .chat-header {
            background: linear-gradient(135deg, var(--mental-health), #7b1fa2);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .therapist-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--mental-health);
            font-size: 1.5rem;
        }

        .therapist-info h3 {
            margin-bottom: 5px;
        }

        .therapist-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--secondary);
        }

        .message-content {
            background: white;
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 70%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .message.user .message-content {
            background: var(--primary);
            color: white;
        }

        .message-time {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .message.user .message-time {
            color: rgba(255, 255, 255, 0.8);
        }

        .chat-input {
            padding: 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }

        .input-field {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            outline: none;
            font-size: 1rem;
            transition: var(--transition);
        }

        .input-field:focus {
            border-color: var(--primary);
        }

        .send-btn {
            width: 45px;
            height: 45px;
            border: none;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .send-btn:hover {
            background: var(--safe);
            transform: scale(1.05);
        }

        .services-sidebar {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .service-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .service-card:hover {
            transform: translateY(-5px);
        }

        .service-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 20px;
        }

        .emergency-support .service-icon {
            background: linear-gradient(135deg, var(--accent), #e53e3e);
        }

        .professional-booking .service-icon {
            background: linear-gradient(135deg, var(--primary), var(--safe));
        }

        .mental-health .service-icon {
            background: linear-gradient(135deg, var(--mental-health), #7b1fa2);
        }

        .resource-center .service-icon {
            background: linear-gradient(135deg, var(--secondary), #2e7d32);
        }

        .service-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .service-desc {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .service-btn {
            background: linear-gradient(135deg, var(--primary), var(--safe));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            width: 100%;
        }

        .service-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(26, 115, 232, 0.3);
        }

        .emergency-btn {
            background: linear-gradient(135deg, var(--accent), #e53e3e);
        }

        .emergency-btn:hover {
            box-shadow: 0 8px 20px rgba(242, 92, 84, 0.3);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: white;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        .crisis-hotline {
            background: linear-gradient(135deg, var(--accent), #e53e3e);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .hotline-number {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .appointment-form {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-modal {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn-cancel {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            background: white;
            color: var(--dark);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .btn-cancel:hover {
            background: #f0f0f0;
        }

        .btn-submit {
            flex: 1;
            padding: 12px;
            border: none;
            background: linear-gradient(135deg, var(--primary), var(--safe));
            color: white;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .emergency-tools {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        .tool-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .tool-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .enhanced-chat-btn {
            background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%) !important;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
            animation: pulse 2s infinite;
        }

        .enhanced-chat-btn:hover {
            background: linear-gradient(135deg, #8e24aa 0%, #5e35b1 100%) !important;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(156, 39, 176, 0.5);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Feature Banner Styles */
        .feature-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .feature-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                transparent 50%, 
                rgba(255, 255, 255, 0.05) 100%);
            pointer-events: none;
        }

        .banner-content {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 1;
        }

        .banner-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .banner-text {
            flex: 1;
            color: white;
        }

        .banner-text h4 {
            font-size: 1.3rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .banner-text p {
            opacity: 0.9;
            margin: 0;
            line-height: 1.4;
        }

        .banner-action {
            margin-left: auto;
        }

        .banner-btn {
            background: rgba(255, 255, 255, 0.9);
            color: var(--primary);
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .banner-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .photo-upload-section {
            display: none;
            padding: 20px;
            background: #f0f8ff;
            border-bottom: 1px solid #e0e0e0;
        }

        .photo-upload-section.active {
            display: block;
        }

        .upload-area {
            border: 2px dashed var(--primary);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area:hover {
            border-color: var(--safe);
            background: #f8f9fa;
        }

        .upload-area.drag-over {
            border-color: var(--secondary);
            background: #e8f5e8;
        }

        .upload-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .photo-preview {
            margin-top: 15px;
            text-align: left;
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .context-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .analyze-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .analyze-btn:hover {
            background: #2e7d32;
            transform: translateY(-1px);
        }

        .analyze-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .emergency-status {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--accent);
            color: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            display: none;
            z-index: 1000;
            min-width: 250px;
        }

        .emergency-status.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .api-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 0.9rem;
            box-shadow: var(--shadow);
            z-index: 1000;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-connected {
            background: var(--secondary);
        }

        .status-disconnected {
            background: var(--accent);
        }

        .emergency-protocols {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .protocols-modal {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .protocol-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            background: #f8f9fa;
            cursor: pointer;
            transition: var(--transition);
        }

        .protocol-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .protocol-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .flood-protocol .protocol-icon {
            background: var(--info);
        }

        .fire-protocol .protocol-icon {
            background: var(--accent);
        }

        .earthquake-protocol .protocol-icon {
            background: var(--warning);
        }

        .panic-protocol .protocol-icon {
            background: var(--mental-health);
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .services-sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .page-title {
                font-size: 2rem;
            }

            .chat-section {
                height: 600px;
            }

            .message-content {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-user-md"></i>
                Consultation & Support
            </div>
            <ul class="nav-menu">
                <li><a href="dashboard-student.html">Dashboard</a></li>
                <li><a href="education-modules.html">Education</a></li>
                <li><a href="profile-badges.html">Profile</a></li>
                <li><a href="gamified-learning.html">Games</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Mental Health & Consultation</h1>
            <p class="page-subtitle">Get professional support, mental health resources, and crisis intervention for disaster-related trauma and stress</p>
        </div>

        <div class="main-content">
            <!-- Feature Highlight Banner -->
            <div class="feature-banner">
                <div class="banner-content">
                    <div class="banner-icon">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <div class="banner-text">
                        <h4>🎉 New: Enhanced AI Chatbot</h4>
                        <p>Experience our upgraded DisasterAI Assistant with advanced UI, animations, and better emergency support!</p>
                    </div>
                    <div class="banner-action">
                        <button class="banner-btn" onclick="openEnhancedChatbot()">
                            <i class="fas fa-robot"></i> Try Enhanced Chat
                        </button>
                    </div>
                </div>
            </div>

            <div class="chat-section">
                <div class="chat-header">
                    <div class="therapist-avatar">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="therapist-info">
                        <h3>DisasterCare AI - Emergency Psychology Assistant</h3>
                        <div class="therapist-status">
                            <div class="status-dot"></div>
                            <span>Online - LLAMA-powered Emergency Support</span>
                        </div>
                    </div>
                    <div class="emergency-tools">
                        <button class="tool-btn" onclick="togglePhotoUpload()" title="Upload disaster photo for assessment">
                            <i class="fas fa-camera"></i>
                        </button>
                        <button class="tool-btn" onclick="emergencyProtocol()" title="Emergency protocols">
                            <i class="fas fa-exclamation-triangle"></i>
                        </button>
                        <button class="tool-btn enhanced-chat-btn" onclick="openEnhancedChatbot()" title="Open Enhanced AI Chatbot (Full Screen)">
                            <i class="fas fa-robot"></i>
                        </button>
                    </div>
                </div>

                <!-- Photo Upload Section -->
                <div class="photo-upload-section" id="photoUploadSection">
                    <div class="upload-area" id="uploadArea" onclick="document.getElementById('photoInput').click()">
                        <div class="upload-icon">
                            <i class="fas fa-camera-retro"></i>
                        </div>
                        <h4>Upload Disaster Photo for AI Analysis</h4>
                        <p>Drop an image here or click to select</p>
                        <small>Supported: JPG, PNG, GIF (max 5MB)</small>
                    </div>
                    
                    <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                    
                    <div class="photo-preview" id="photoPreview" style="display: none;">
                        <img id="previewImage" class="preview-image" alt="Uploaded photo">
                        <textarea class="context-input" id="photoContext" placeholder="Describe your situation: 'I'm a student trapped in college during flood' or 'Fire alarm went off, we see smoke under the door'"></textarea>
                        <button class="analyze-btn" id="analyzeBtn" onclick="analyzeDisasterPhoto()">
                            <i class="fas fa-brain"></i> Analyze with AI
                        </button>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <div class="message">
                        <div class="message-avatar">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="message-content">
                            <p>🚨 <strong>Emergency Psychology AI Activated</strong></p>
                            <p>I'm DisasterCare AI, powered by LLAMA and specialized in emergency psychological support. I can help with:</p>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li><strong>📸 Photo Analysis:</strong> Upload disaster photos for safety assessment</li>
                                <li><strong>🧠 Psychological Support:</strong> Manage panic, anxiety, and stress</li>
                                <li><strong>📚 Educational Guidance:</strong> Learn proper emergency response</li>
                                <li><strong>⚡ Crisis Intervention:</strong> Immediate emergency protocols</li>
                            </ul>
                            <p><strong>How can I help you stay safe?</strong></p>
                            <div class="message-time">Now</div>
                        </div>
                    </div>

                    <div class="typing-indicator" id="typingIndicator">
                        <div class="message-avatar">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                        <span style="margin-left: 10px; color: #666;">AI is analyzing...</span>
                    </div>
                </div>

                <div class="chat-input">
                    <input type="text" class="input-field" placeholder="Describe your emergency situation..." id="messageInput">
                    <button class="send-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <div class="services-sidebar">
                <div class="crisis-hotline">
                    <i class="fas fa-phone" style="font-size: 1.5rem; margin-bottom: 10px;"></i>
                    <div>24/7 Crisis Hotline</div>
                    <div class="hotline-number">1-800-CRISIS</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">Immediate help available</div>
                </div>

                <div class="service-card emergency-support">
                    <div class="service-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3 class="service-title">Emergency Support</h3>
                    <p class="service-desc">Immediate crisis intervention and psychological first aid for acute disaster trauma.</p>
                    <button class="service-btn emergency-btn" onclick="emergencySupport()">Get Immediate Help</button>
                </div>

                <div class="service-card professional-booking">
                    <div class="service-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h3 class="service-title">Book Professional Session</h3>
                    <p class="service-desc">Schedule a session with licensed therapists specializing in disaster psychology.</p>
                    <button class="service-btn" onclick="showBookingForm()">Book Appointment</button>
                </div>

                <div class="service-card mental-health">
                    <div class="service-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3 class="service-title">Mental Health Resources</h3>
                    <p class="service-desc">Access self-help tools, meditation guides, and stress management techniques.</p>
                    <button class="service-btn" onclick="mentalHealthResources()">Explore Resources</button>
                </div>

                <div class="service-card resource-center">
                    <div class="service-icon">
                        <i class="fas fa-book-medical"></i>
                    </div>
                    <h3 class="service-title">Educational Resources</h3>
                    <p class="service-desc">Learn about trauma recovery, resilience building, and psychological preparedness.</p>
                    <button class="service-btn" onclick="educationalResources()">Learn More</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Appointment Booking Modal -->
    <div class="appointment-form" id="appointmentModal" style="display: none;">
        <div class="form-modal">
            <h2 style="margin-bottom: 20px; color: var(--primary);">Book Professional Session</h2>
            
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" class="form-input" id="patientName" placeholder="Enter your full name">
            </div>

            <div class="form-group">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-input" id="patientEmail" placeholder="your.email@example.com">
            </div>

            <div class="form-group">
                <label class="form-label">Phone Number</label>
                <input type="tel" class="form-input" id="patientPhone" placeholder="+1 (555) 123-4567">
            </div>

            <div class="form-group">
                <label class="form-label">Preferred Session Type</label>
                <select class="form-select" id="sessionType">
                    <option value="">Select session type</option>
                    <option value="individual">Individual Therapy</option>
                    <option value="group">Group Therapy</option>
                    <option value="family">Family Counseling</option>
                    <option value="crisis">Crisis Intervention</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Preferred Date & Time</label>
                <input type="datetime-local" class="form-input" id="sessionDateTime">
            </div>

            <div class="form-group">
                <label class="form-label">Urgency Level</label>
                <select class="form-select" id="urgencyLevel">
                    <option value="">Select urgency</option>
                    <option value="low">Low - Regular appointment</option>
                    <option value="medium">Medium - Within 3 days</option>
                    <option value="high">High - Within 24 hours</option>
                    <option value="emergency">Emergency - Immediate help</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Describe Your Concerns</label>
                <textarea class="form-textarea" id="concerns" placeholder="Please describe what you'd like to discuss in your session..."></textarea>
            </div>

            <div class="form-actions">
                <button class="btn-cancel" onclick="hideBookingForm()">Cancel</button>
                <button class="btn-submit" onclick="submitBooking()">Book Session</button>
            </div>
        </div>
    </div>

        </div>
    </div>

    <!-- Emergency Protocols Modal -->
    <div class="emergency-protocols" id="emergencyProtocols">
        <div class="protocols-modal">
            <h2 style="margin-bottom: 20px; color: var(--accent);">
                <i class="fas fa-exclamation-triangle"></i> Emergency Protocols
            </h2>
            
            <div class="protocol-item flood-protocol" onclick="applyProtocol('flood')">
                <div class="protocol-icon">
                    <i class="fas fa-water"></i>
                </div>
                <div>
                    <h4>Flood Emergency Protocol</h4>
                    <p>Immediate steps for flood situations and water hazards</p>
                </div>
            </div>

            <div class="protocol-item fire-protocol" onclick="applyProtocol('fire')">
                <div class="protocol-icon">
                    <i class="fas fa-fire"></i>
                </div>
                <div>
                    <h4>Fire Emergency Protocol</h4>
                    <p>Evacuation procedures and smoke safety guidelines</p>
                </div>
            </div>

            <div class="protocol-item earthquake-protocol" onclick="applyProtocol('earthquake')">
                <div class="protocol-icon">
                    <i class="fas fa-home"></i>
                </div>
                <div>
                    <h4>Earthquake/Structural Protocol</h4>
                    <p>Drop, cover, hold procedures and building safety</p>
                </div>
            </div>

            <div class="protocol-item panic-protocol" onclick="applyProtocol('panic')">
                <div class="protocol-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <div>
                    <h4>Panic Attack Management</h4>
                    <p>Breathing techniques and grounding exercises</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn-cancel" onclick="closeEmergencyProtocols()">Close</button>
            </div>
        </div>
    </div>

    <!-- Emergency Status Banner -->
    <div class="emergency-status" id="emergencyStatus">
        <div style="font-weight: bold; margin-bottom: 5px;">
            <i class="fas fa-exclamation-triangle"></i> Emergency Mode Active
        </div>
        <div style="font-size: 0.9rem;">AI analyzing situation...</div>
    </div>

    <!-- API Connection Status -->
    <div class="api-status" id="apiStatus">
        <span class="status-indicator status-disconnected"></span>
        Connecting to AI...
    </div>

    <!-- Appointment Booking Modal -->
    <div class="appointment-form" id="appointmentModal" style="display: none;">
        <div class="form-modal">
            <h2 style="margin-bottom: 20px; color: var(--primary);">Book Professional Session</h2>
            
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" class="form-input" id="patientName" placeholder="Enter your full name">
            </div>

            <div class="form-group">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-input" id="patientEmail" placeholder="your.email@example.com">
            </div>

            <div class="form-group">
                <label class="form-label">Phone Number</label>
                <input type="tel" class="form-input" id="patientPhone" placeholder="+1 (555) 123-4567">
            </div>

            <div class="form-group">
                <label class="form-label">Preferred Session Type</label>
                <select class="form-select" id="sessionType">
                    <option value="">Select session type</option>
                    <option value="individual">Individual Therapy</option>
                    <option value="group">Group Therapy</option>
                    <option value="family">Family Counseling</option>
                    <option value="crisis">Crisis Intervention</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Preferred Date & Time</label>
                <input type="datetime-local" class="form-input" id="sessionDateTime">
            </div>

            <div class="form-group">
                <label class="form-label">Urgency Level</label>
                <select class="form-select" id="urgencyLevel">
                    <option value="">Select urgency</option>
                    <option value="low">Low - Regular appointment</option>
                    <option value="medium">Medium - Within 3 days</option>
                    <option value="high">High - Within 24 hours</option>
                    <option value="emergency">Emergency - Immediate help</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Describe Your Concerns</label>
                <textarea class="form-textarea" id="concerns" placeholder="Please describe what you'd like to discuss in your session..."></textarea>
            </div>

            <div class="form-actions">
                <button class="btn-cancel" onclick="hideBookingForm()">Cancel</button>
                <button class="btn-submit" onclick="submitBooking()">Book Session</button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE_URL = 'http://localhost:5000';
        let sessionId = 'session_' + Date.now();
        let isPhotoUploadVisible = false;
        let currentPhoto = null;
        
        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const typingIndicator = document.getElementById('typingIndicator');
        const photoUploadSection = document.getElementById('photoUploadSection');
        const apiStatus = document.getElementById('apiStatus');
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAPIConnection();
            setupDragAndDrop();
            initializeChat();
        });

        // API Connection Management
        async function checkAPIConnection() {
            try {
                const response = await fetch(`${API_BASE_URL}/health`);
                if (response.ok) {
                    updateAPIStatus(true, 'Connected to DisasterCare AI');
                } else {
                    throw new Error('API not responding');
                }
            } catch (error) {
                updateAPIStatus(false, 'Offline - Using fallback responses');
                console.warn('API connection failed, using fallback mode');
            }
        }

        function updateAPIStatus(connected, message) {
            const statusIndicator = apiStatus.querySelector('.status-indicator');
            statusIndicator.className = `status-indicator ${connected ? 'status-connected' : 'status-disconnected'}`;
            apiStatus.innerHTML = `${statusIndicator.outerHTML}${message}`;
        }

        // Chat Functions
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message
            addMessage(message, 'user');
            messageInput.value = '';

            // Show typing indicator
            showTypingIndicator();

            try {
                // Send to AI API
                const response = await fetch(`${API_BASE_URL}/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        session_id: sessionId
                    })
                });

                const data = await response.json();
                
                hideTypingIndicator();
                
                if (data.success) {
                    addMessage(data.response, 'ai');
                } else {
                    // Fallback response
                    const fallbackResponse = data.fallback_response || generateFallbackResponse(message);
                    addMessage(fallbackResponse, 'ai');
                }
            } catch (error) {
                hideTypingIndicator();
                console.error('Error sending message:', error);
                addMessage(generateFallbackResponse(message), 'ai');
            }
        }

        function addMessage(content, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender === 'user' ? 'user' : ''}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.innerHTML = sender === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-brain"></i>';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            
            // Process AI response formatting
            let formattedContent = content;
            if (sender === 'ai') {
                formattedContent = formatAIResponse(content);
            }
            
            messageContent.innerHTML = `
                <div>${formattedContent}</div>
                <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
            `;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            // Insert before typing indicator
            chatMessages.insertBefore(messageDiv, typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function formatAIResponse(response) {
            // Format AI response with proper styling for different sections
            return response
                .replace(/\[EMERGENCY\]/g, '<span style="color: #f25c54; font-weight: bold;">🚨 EMERGENCY:</span>')
                .replace(/\[CALM\]/g, '<span style="color: #9c27b0; font-weight: bold;">🧠 PSYCHOLOGY:</span>')
                .replace(/\[EDUCATION\]/g, '<span style="color: #1a73e8; font-weight: bold;">📚 GUIDANCE:</span>')
                .replace(/\[BREATHING\]/g, '<span style="color: #34a853; font-weight: bold;">🫁 BREATHING:</span>')
                .replace(/\[GROUNDING\]/g, '<span style="color: #f9a825; font-weight: bold;">⚡ GROUNDING:</span>')
                .replace(/\[PHOTO_ANALYSIS\]/g, '<span style="color: #17a2b8; font-weight: bold;">📸 ANALYSIS:</span>')
                .replace(/\[CRITICAL\]/g, '<span style="color: #dc3545; font-weight: bold; background: #fff3cd; padding: 2px 6px; border-radius: 4px;">⚠️ CRITICAL</span>')
                .replace(/\[IMMEDIATE_ACTIONS\]/g, '<span style="color: #e83e8c; font-weight: bold;">🚀 IMMEDIATE ACTIONS:</span>')
                .replace(/\[CONFIDENCE\]/g, '<span style="color: #6c757d; font-style: italic;">📊 CONFIDENCE:</span>');
        }

        function generateFallbackResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            if (message.includes('flood') || message.includes('water')) {
                return "🚨 EMERGENCY: If you're dealing with flood water, do NOT attempt to walk through moving water. Even 6 inches can knock you down. Stay where you are, move to the highest point available, and signal for help using your phone flashlight or loud noises.";
            } else if (message.includes('fire') || message.includes('smoke')) {
                return "🚨 EMERGENCY: For fire/smoke situations, stay low where air is cleaner. Feel doors before opening - if hot, don't open. Exit immediately if you have a safe path. If trapped, seal gaps and signal from windows.";
            } else if (message.includes('earthquake') || message.includes('trapped')) {
                return "🚨 EMERGENCY: During earthquakes: DROP to hands/knees, COVER head/neck, HOLD ON to sturdy furniture. If building is damaged after, exit carefully and watch for falling debris.";
            } else if (message.includes('panic') || message.includes('scared') || message.includes('afraid')) {
                return "🧠 PSYCHOLOGY: I understand you're feeling overwhelmed. Take a slow, deep breath with me: In for 4 counts... hold for 4... out for 6 counts. This helps activate your calm response. You're not alone in this.";
            } else {
                return "🧠 I'm here to help you through this situation. Can you tell me more about what you're experiencing? Are you in immediate physical danger, or do you need help with anxiety and stress management?";
            }
        }

        // Photo Upload Functions
        function togglePhotoUpload() {
            isPhotoUploadVisible = !isPhotoUploadVisible;
            photoUploadSection.classList.toggle('active', isPhotoUploadVisible);
            
            if (isPhotoUploadVisible) {
                addMessage("📸 Photo analysis mode activated. Upload a disaster photo and describe your situation for AI-powered safety assessment.", 'ai');
            }
        }

        function setupDragAndDrop() {
            const uploadArea = document.getElementById('uploadArea');
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handlePhotoFile(files[0]);
                }
            });
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                handlePhotoFile(file);
            }
        }

        function handlePhotoFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Please select an image file.');
                return;
            }
            
            if (file.size > 5 * 1024 * 1024) {
                alert('Image must be smaller than 5MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                currentPhoto = {
                    file: file,
                    dataUrl: e.target.result,
                    name: file.name
                };
                
                displayPhotoPreview(e.target.result, file.name);
            };
            reader.readAsDataURL(file);
        }

        function displayPhotoPreview(dataUrl, fileName) {
            const preview = document.getElementById('photoPreview');
            const previewImage = document.getElementById('previewImage');
            
            previewImage.src = dataUrl;
            preview.style.display = 'block';
            
            addMessage(`📸 Photo uploaded: ${fileName}. Please describe your situation in the text box above, then click "Analyze with AI".`, 'ai');
        }

        async function analyzeDisasterPhoto() {
            if (!currentPhoto) {
                alert('Please upload a photo first.');
                return;
            }
            
            const context = document.getElementById('photoContext').value.trim();
            if (!context) {
                alert('Please describe your situation for better analysis.');
                return;
            }
            
            const analyzeBtn = document.getElementById('analyzeBtn');
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';
            
            showTypingIndicator();
            showEmergencyStatus(true);
            
            try {
                // Simulate image description extraction (in real implementation, this would use computer vision)
                const imageDescription = await generateImageDescription(currentPhoto);
                
                // Send to visual assessment API
                const response = await fetch(`${API_BASE_URL}/analyze-image`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        image_description: imageDescription,
                        user_context: context,
                        session_id: sessionId
                    })
                });

                const data = await response.json();
                
                hideTypingIndicator();
                showEmergencyStatus(false);
                
                if (data.success) {
                    addMessage(`📸 PHOTO ANALYSIS COMPLETE:\n\n${data.response}`, 'ai');
                    
                    // Add assessment summary
                    if (data.assessment) {
                        const assessment = data.assessment;
                        const summary = `\n📊 ASSESSMENT SUMMARY:\n• Disaster Type: ${assessment.disaster_type}\n• Severity: ${assessment.severity_level}\n• Confidence: ${Math.round(assessment.confidence_score * 100)}%`;
                        addMessage(summary, 'ai');
                    }
                } else {
                    const fallbackResponse = data.fallback_response || "⚠️ I'm having trouble analyzing the image, but please prioritize your safety. If you're in immediate danger, evacuate to a safe location and contact emergency services.";
                    addMessage(fallbackResponse, 'ai');
                }
            } catch (error) {
                hideTypingIndicator();
                showEmergencyStatus(false);
                console.error('Error analyzing photo:', error);
                addMessage("⚠️ Photo analysis failed, but I can still help. Based on your description, please prioritize your safety and contact emergency services if you're in danger.", 'ai');
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-brain"></i> Analyze with AI';
            }
        }

        async function generateImageDescription(photo) {
            // Simulate image analysis (in production, integrate with computer vision API)
            const fileName = photo.name.toLowerCase();
            const context = document.getElementById('photoContext').value.toLowerCase();
            
            let description = "Image shows ";
            
            if (context.includes('flood') || context.includes('water')) {
                description += "flood water in an indoor space, water level appears to be ";
                if (context.includes('knee')) description += "knee-deep";
                else if (context.includes('ankle')) description += "ankle-deep";
                else description += "moderate depth";
                description += ", with visible debris floating in muddy water";
            } else if (context.includes('fire') || context.includes('smoke')) {
                description += "smoke visible in indoor environment, ";
                if (context.includes('heavy') || context.includes('thick')) description += "heavy smoke concentration";
                else description += "light to moderate smoke";
                description += ", potential fire hazard present";
            } else if (context.includes('earthquake') || context.includes('damage')) {
                description += "structural damage including cracks in walls/ceiling, ";
                if (context.includes('major') || context.includes('large')) description += "significant structural damage";
                else description += "minor to moderate damage";
                description += ", potential instability";
            } else {
                description += "emergency situation requiring assessment, visible hazards present";
            }
            
            return description;
        }

        // Emergency Protocol Functions
        function emergencyProtocol() {
            document.getElementById('emergencyProtocols').style.display = 'flex';
        }

        function closeEmergencyProtocols() {
            document.getElementById('emergencyProtocols').style.display = 'none';
        }

        function applyProtocol(type) {
            closeEmergencyProtocols();
            
            const protocols = {
                flood: "🌊 FLOOD PROTOCOL ACTIVATED:\n\n1. DO NOT walk through moving water (6+ inches can knock you down)\n2. Move to highest available point\n3. Signal for help using phone flashlight/noise\n4. Avoid contact with flood water (contamination risk)\n5. Wait for professional rescue\n\n🧠 Stay calm - you're taking the right steps by being cautious.",
                
                fire: "🔥 FIRE PROTOCOL ACTIVATED:\n\n1. Stay LOW (smoke rises, cleaner air near floor)\n2. Feel doors before opening (hot = don't open)\n3. Exit immediately via safest route\n4. If trapped: seal gaps, signal from windows\n5. NEVER return to building after evacuation\n\n🧠 Your quick action can save lives. Stay focused and calm.",
                
                earthquake: "🏠 EARTHQUAKE PROTOCOL ACTIVATED:\n\n1. DROP to hands/knees immediately\n2. COVER head/neck with arms\n3. HOLD ON to sturdy furniture if available\n4. Stay in position until shaking stops\n5. Exit carefully if building damaged\n\n🧠 Remember: most injuries occur from falling objects, not building collapse.",
                
                panic: "🧠 PANIC MANAGEMENT ACTIVATED:\n\n1. BREATHING: 4 counts in, hold 4, out 6 counts\n2. GROUNDING: Name 5 things you see, 4 you touch, 3 you hear\n3. REMIND: 'This feeling will pass, I am safe right now'\n4. FOCUS: On immediate physical safety first\n5. REACH OUT: You're not alone, help is available\n\n💙 Panic is temporary. You have the strength to get through this."
            };
            
            const protocol = protocols[type];
            if (protocol) {
                addMessage(protocol, 'ai');
                showEmergencyStatus(true, 'Emergency Protocol Active');
                setTimeout(() => showEmergencyStatus(false), 5000);
            }
        }

        // Enhanced Chatbot Integration
        function openEnhancedChatbot() {
            const confirmed = confirm('🤖 Enhanced AI Chatbot\n\nOpen the full-screen DisasterAI Assistant with advanced features?\n\n✨ Features:\n• Enhanced UI/UX with animations\n• Advanced AI responses\n• File upload support\n• Typing indicators\n• Better emergency protocols\n\nThis will open in a new window.');
            
            if (confirmed) {
                // Open chatbot in new window with optimal size
                const chatbotWindow = window.open(
                    'chatbot.html',
                    'DisasterAI_Chatbot',
                    'width=1000,height=700,resizable=yes,scrollbars=yes,status=yes,location=no,toolbar=no,menubar=no'
                );
                
                if (chatbotWindow) {
                    chatbotWindow.focus();
                    
                    // Add message to current chat indicating the user opened enhanced chatbot
                    addMessage('🚀 Enhanced AI Chatbot opened in new window. You can use both interfaces simultaneously for comprehensive support.', 'ai');
                } else {
                    // Fallback if popup was blocked
                    alert('❌ Popup blocked!\n\nPlease allow popups for this site or manually open chatbot.html in a new tab.\n\nYou can also:\n1. Right-click the robot button\n2. Select "Open link in new tab"\n3. Or copy this URL: chatbot.html');
                    
                    // Provide alternative navigation
                    addMessage('💡 **Alternative:** You can also navigate directly to chatbot.html for the enhanced experience.', 'ai');
                }
            }
        }

        function showEmergencyStatus(show, message = 'Emergency Mode Active') {
            const status = document.getElementById('emergencyStatus');
            if (show) {
                status.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 5px;">
                        <i class="fas fa-exclamation-triangle"></i> ${message}
                    </div>
                    <div style="font-size: 0.9rem;">AI analyzing situation...</div>
                `;
                status.classList.add('active');
            } else {
                status.classList.remove('active');
            }
        }

        // Utility Functions
        function showTypingIndicator() {
            typingIndicator.style.display = 'flex';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        function initializeChat() {
            setTimeout(() => {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 100);
        }

        // Emergency Support Functions
        function emergencySupport() {
            showEmergencyStatus(true, 'EMERGENCY SUPPORT ACTIVATED');
            
            addMessage("🚨 EMERGENCY SUPPORT ACTIVATED:\n\n• Call 911 for immediate danger\n• Crisis Hotline: 988 (Suicide & Crisis Lifeline)\n• Text 'HOME' to 741741 for crisis text line\n\nI'm here to support you through this crisis. You're not alone.", 'ai');
            
            setTimeout(() => showEmergencyStatus(false), 10000);
        }

        // Other existing functions (booking, resources, etc.)
        function showBookingForm() {
            document.getElementById('appointmentModal').style.display = 'flex';
        }

        function hideBookingForm() {
            document.getElementById('appointmentModal').style.display = 'none';
        }

        function submitBooking() {
            const name = document.getElementById('patientName').value;
            const email = document.getElementById('patientEmail').value;
            const sessionType = document.getElementById('sessionType').value;
            const urgency = document.getElementById('urgencyLevel').value;

            if (!name || !email || !sessionType || !urgency) {
                alert('Please fill in all required fields.');
                return;
            }

            alert(`✅ Appointment Request Submitted!\n\nName: ${name}\nSession Type: ${sessionType}\nUrgency: ${urgency}\n\nA mental health professional will contact you within 24 hours.`);
            
            hideBookingForm();
            addMessage("✅ I see you've submitted an appointment request. That's a positive step toward getting professional support. In the meantime, I'm here for immediate psychological assistance.", 'ai');
        }

        function mentalHealthResources() {
            addMessage("🧠 MENTAL HEALTH RESOURCES:\n\n• Breathing Exercises: 4-7-8 technique for anxiety\n• Mindfulness Apps: Calm, Headspace, Insight Timer\n• Grounding: 5-4-3-2-1 sensory method\n• Crisis Text Line: Text HOME to 741741\n• National Suicide Prevention: 988\n\nThese resources are available 24/7 for self-care support.", 'ai');
        }

        function educationalResources() {
            addMessage("📚 EDUCATIONAL RESOURCES:\n\n• Understanding Disaster Psychology\n• Building Resilience After Trauma\n• Emergency Response Protocols\n• Community Healing Strategies\n• Supporting Others in Crisis\n• Post-Traumatic Growth\n\nKnowledge empowers recovery and preparedness.", 'ai');
        }

        // Keyboard event for sending messages
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Periodic API health check
        setInterval(checkAPIConnection, 30000); // Check every 30 seconds
    </script>
</body>
</html>